{"ast":null,"code":"import _slicedToArray from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useCallback}from\"react\";import{useNavigate,useLocation}from\"react-router\";import axios from\"axios\";import LoadingSpinner from\"../components/loader/ButtonLoadingSpinner\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BASE_URL=process.env.REACT_APP_API_URL;var VerifyEmail=function VerifyEmail(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var navigate=useNavigate();var location=useLocation();var searchParams=new URLSearchParams(location.search);var codeFromUrl=searchParams.get(\"code\");var emailFromUrl=searchParams.get(\"email\");var email=location.state?location.state:emailFromUrl;var _useState3=useState(codeFromUrl?codeFromUrl:\"\"),_useState4=_slicedToArray(_useState3,2),code=_useState4[0],setCode=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var handleCodeChange=function handleCodeChange(e){setCode(e.target.value);};var handleVerify=useCallback(function(){setLoading(true);var verificationLink=\"\".concat(BASE_URL,\"/auth/verify?code=\").concat(code,\"&email=\").concat(email);axios.get(verificationLink).then(function(res){if(res.status===200){navigate(\"/email-verified\");setCode(\"\");setError(\"\");setLoading(false);}}).catch(function(err){setError(err.response.data.message||\"Invalid code, please try again.\");setLoading(false);});},[code,email,navigate,setLoading,setError]);useEffect(function(){// Automatically trigger handleVerify if both code and email are present in the URL\nif(codeFromUrl&&emailFromUrl){handleVerify();}},[codeFromUrl,emailFromUrl,handleVerify]);if(error===\"Email is already verified\"){navigate(\"/signin\");}return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-10 overflow-y-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex min-h-screen items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-md bg-white p-6 shadow-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-4 text-2xl font-bold\",children:\"Verify your email address\"}),!codeFromUrl&&!emailFromUrl&&/*#__PURE__*/_jsxs(\"p\",{className:\"mb-4\",children:[\"A verification code was sent to your email address. Please either\",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:\" follow \"}),\"the link in the email or\",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:\" enter \"}),\"the code below.\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Verification code\",className:\"w-full rounded-lg border-2 border-gray-200 p-2\",value:code,onChange:handleCodeChange})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 text-sm text-red-500\",children:error}),/*#__PURE__*/_jsx(\"button\",{disabled:loading,className:\"rounded-lg bg-blue-500 px-4 py-2 text-white hover:bg-blue-600\",onClick:handleVerify,children:loading?/*#__PURE__*/_jsx(LoadingSpinner,{loadingText:\"Verifying...\"}):\"Verify\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ml-4 rounded-lg bg-gray-300 px-4 py-2 text-gray-800 hover:bg-gray-400\",onClick:function onClick(){navigate(\"/signup\");},children:\"Cancel\"})]})})});};export default VerifyEmail;","map":{"version":3,"names":["useState","useEffect","useCallback","useNavigate","useLocation","axios","LoadingSpinner","jsx","_jsx","jsxs","_jsxs","BASE_URL","process","env","REACT_APP_API_URL","VerifyEmail","_useState","_useState2","_slicedToArray","loading","setLoading","navigate","location","searchParams","URLSearchParams","search","codeFromUrl","get","emailFromUrl","email","state","_useState3","_useState4","code","setCode","_useState5","_useState6","error","setError","handleCodeChange","e","target","value","handleVerify","verificationLink","concat","then","res","status","catch","err","response","data","message","className","children","type","placeholder","onChange","disabled","onClick","loadingText"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/pages/VerifyEmail.jsx"],"sourcesContent":["import { useState, useEffect, useCallback } from \"react\";\nimport { useNavigate, useLocation } from \"react-router\";\nimport axios from \"axios\";\nimport LoadingSpinner from \"../components/loader/ButtonLoadingSpinner\";\n\nconst BASE_URL = process.env.REACT_APP_API_URL;\n\nconst VerifyEmail = () => {\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const searchParams = new URLSearchParams(location.search);\n  const codeFromUrl = searchParams.get(\"code\");\n  const emailFromUrl = searchParams.get(\"email\");\n  const email = location.state ? location.state : emailFromUrl;\n\n  const [code, setCode] = useState(codeFromUrl ? codeFromUrl : \"\");\n  const [error, setError] = useState(\"\");\n\n  const handleCodeChange = (e) => {\n    setCode(e.target.value);\n  };\n\n  const handleVerify = useCallback(() => {\n    setLoading(true);\n    const verificationLink = `${BASE_URL}/auth/verify?code=${code}&email=${email}`;\n    axios\n      .get(verificationLink)\n      .then((res) => {\n        if (res.status === 200) {\n          navigate(\"/email-verified\");\n          setCode(\"\");\n          setError(\"\");\n          setLoading(false);\n        }\n      })\n      .catch((err) => {\n        setError(\n          err.response.data.message || \"Invalid code, please try again.\"\n        );\n\n        setLoading(false);\n      });\n  }, [code, email, navigate, setLoading, setError]);\n\n  useEffect(() => {\n    // Automatically trigger handleVerify if both code and email are present in the URL\n    if (codeFromUrl && emailFromUrl) {\n      handleVerify();\n    }\n  }, [codeFromUrl, emailFromUrl, handleVerify]);\n\n  if (error === \"Email is already verified\") {\n    navigate(\"/signin\");\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-10 overflow-y-auto\">\n      <div className=\"flex min-h-screen items-center justify-center\">\n        <div className=\"rounded-md bg-white p-6 shadow-md\">\n          <h2 className=\"mb-4 text-2xl font-bold\">Verify your email address</h2>\n\n          {!codeFromUrl && !emailFromUrl && (\n            <p className=\"mb-4\">\n              A verification code was sent to your email address. Please either\n              <span className=\"font-bold\"> follow </span>\n              the link in the email or\n              <span className=\"font-bold\"> enter </span>\n              the code below.\n            </p>\n          )}\n\n          <div className=\"mb-4\">\n            <input\n              type=\"text\"\n              placeholder=\"Verification code\"\n              className=\"w-full rounded-lg border-2 border-gray-200 p-2\"\n              value={code}\n              onChange={handleCodeChange}\n            />\n          </div>\n          {error && <div className=\"mb-4 text-sm text-red-500\">{error}</div>}\n          <button\n            disabled={loading}\n            className=\"rounded-lg bg-blue-500 px-4 py-2 text-white hover:bg-blue-600\"\n            onClick={handleVerify}\n          >\n            {loading ? (\n              <LoadingSpinner loadingText={\"Verifying...\"} />\n            ) : (\n              \"Verify\"\n            )}\n          </button>\n          <button\n            className=\"ml-4 rounded-lg bg-gray-300 px-4 py-2 text-gray-800 hover:bg-gray-400\"\n            onClick={() => {\n              navigate(\"/signup\");\n            }}\n          >\n            Cancel\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default VerifyEmail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}