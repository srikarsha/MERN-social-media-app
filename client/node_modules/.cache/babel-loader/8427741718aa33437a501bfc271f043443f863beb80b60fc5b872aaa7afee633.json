{"ast":null,"code":"import _regeneratorRuntime from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState,memo}from\"react\";import{HiOutlineArchiveBoxArrowDown,HiOutlineArchiveBoxXMark}from\"react-icons/hi2\";import{useDispatch,useSelector}from\"react-redux\";import{savePostAction,unsavePostAction,getSavedPostsAction,increaseSavedByCount,decreaseSavedByCount}from\"../../redux/actions/postActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Save=function Save(_ref){var postId=_ref.postId;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),saved=_useState2[0],setSaved=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSaving=_useState4[0],setIsSaving=_useState4[1];var savedPosts=useSelector(function(state){var _state$posts;return(_state$posts=state.posts)===null||_state$posts===void 0?void 0:_state$posts.savedPosts;});var savedPostsIds=savedPosts.map(function(post){return post._id;});useEffect(function(){dispatch(getSavedPostsAction());},[dispatch]);useEffect(function(){if(savedPostsIds.includes(postId)){setSaved(true);}else{setSaved(false);}},[postId,savedPostsIds]);var handleSave=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setIsSaving(true);_context.next=4;return dispatch(savePostAction(postId));case 4:dispatch(increaseSavedByCount(postId));setSaved(true);case 6:_context.prev=6;setIsSaving(false);return _context.finish(6);case 9:case\"end\":return _context.stop();}},_callee,null,[[0,,6,9]]);}));return function handleSave(){return _ref2.apply(this,arguments);};}();var handleUnsave=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setIsSaving(true);_context2.next=4;return dispatch(unsavePostAction(postId));case 4:dispatch(decreaseSavedByCount(postId));setSaved(false);case 6:_context2.prev=6;setIsSaving(false);return _context2.finish(6);case 9:case\"end\":return _context2.stop();}},_callee2,null,[[0,,6,9]]);}));return function handleUnsave(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"button\",{onClick:saved?handleUnsave:handleSave,className:\"flex items-center gap-1 mr-2 tooltip\",disabled:isSaving,children:isSaving?\"Saving...\":saved?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"tooltiptext\",children:\"Remove from saved\"}),/*#__PURE__*/_jsx(HiOutlineArchiveBoxXMark,{className:\"text-2xl\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"tooltiptext\",children:\"Save post\"}),/*#__PURE__*/_jsx(HiOutlineArchiveBoxArrowDown,{className:\"text-2xl\"})]})});};export default/*#__PURE__*/memo(Save);","map":{"version":3,"names":["useEffect","useState","memo","HiOutlineArchiveBoxArrowDown","HiOutlineArchiveBoxXMark","useDispatch","useSelector","savePostAction","unsavePostAction","getSavedPostsAction","increaseSavedByCount","decreaseSavedByCount","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Save","_ref","postId","dispatch","_useState","_useState2","_slicedToArray","saved","setSaved","_useState3","_useState4","isSaving","setIsSaving","savedPosts","state","_state$posts","posts","savedPostsIds","map","post","_id","includes","handleSave","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","finish","stop","apply","arguments","handleUnsave","_ref3","_callee2","_callee2$","_context2","onClick","className","disabled","children"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/components/post/Save.jsx"],"sourcesContent":["import { useEffect, useState, memo } from \"react\";\nimport {\n  HiOutlineArchiveBoxArrowDown,\n  HiOutlineArchiveBoxXMark,\n} from \"react-icons/hi2\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  savePostAction,\n  unsavePostAction,\n  getSavedPostsAction,\n  increaseSavedByCount,\n  decreaseSavedByCount,\n} from \"../../redux/actions/postActions\";\n\nconst Save = ({ postId }) => {\n  const dispatch = useDispatch();\n\n  const [saved, setSaved] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const savedPosts = useSelector((state) => state.posts?.savedPosts);\n  const savedPostsIds = savedPosts.map((post) => post._id);\n\n  useEffect(() => {\n    dispatch(getSavedPostsAction());\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (savedPostsIds.includes(postId)) {\n      setSaved(true);\n    } else {\n      setSaved(false);\n    }\n  }, [postId, savedPostsIds]);\n\n  const handleSave = async () => {\n    try {\n      setIsSaving(true);\n      await dispatch(savePostAction(postId));\n      dispatch(increaseSavedByCount(postId));\n      setSaved(true);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleUnsave = async () => {\n    try {\n      setIsSaving(true);\n      await dispatch(unsavePostAction(postId));\n      dispatch(decreaseSavedByCount(postId));\n      setSaved(false);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  return (\n    <button\n      onClick={saved ? handleUnsave : handleSave}\n      className=\"flex items-center gap-1 mr-2 tooltip\"\n      disabled={isSaving}\n    >\n      {isSaving ? (\n        \"Saving...\"\n      ) : saved ? (\n        <>\n          <span className=\"tooltiptext\">Remove from saved</span>\n          <HiOutlineArchiveBoxXMark className=\"text-2xl\" />\n        </>\n      ) : (\n        <>\n          <span className=\"tooltiptext\">Save post</span>\n          <HiOutlineArchiveBoxArrowDown className=\"text-2xl\" />\n        </>\n      )}\n    </button>\n  );\n};\n\nexport default memo(Save);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}