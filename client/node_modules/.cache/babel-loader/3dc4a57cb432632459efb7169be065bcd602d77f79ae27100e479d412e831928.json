{"ast":null,"code":"import _slicedToArray from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{memo,useMemo,useEffect,useState,useCallback}from\"react\";import{getPostsAction,clearPostsAction}from\"../../redux/actions/postActions\";import{useSelector,useDispatch}from\"react-redux\";import Post from\"../post/Post\";import CommonLoading from\"../loader/CommonLoading\";import Home from\"../../assets/home.jpg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var MemoizedPost=/*#__PURE__*/memo(Post);var LoadMoreButton=function LoadMoreButton(_ref){var onClick=_ref.onClick,isLoading=_ref.isLoading;return/*#__PURE__*/_jsx(\"button\",{className:\"bg-primary hover:bg-blue-700 text-sm text-white font-semibold rounded-md w-full p-2 my-3\",onClick:onClick,disabled:isLoading,children:isLoading?\"Loading...\":\"Load More Posts\"});};var MainSection=function MainSection(_ref2){var userData=_ref2.userData;var dispatch=useDispatch();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var posts=useSelector(function(state){var _state$posts;return(_state$posts=state.posts)===null||_state$posts===void 0?void 0:_state$posts.posts;});var totalPosts=useSelector(function(state){var _state$posts2;return(_state$posts2=state.posts)===null||_state$posts2===void 0?void 0:_state$posts2.totalPosts;});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoadMoreLoading=_useState4[0],setIsLoadMoreLoading=_useState4[1];var LIMIT=10;useEffect(function(){if(userData){dispatch(getPostsAction(LIMIT,0)).finally(function(){setIsLoading(false);});}return function(){dispatch(clearPostsAction());};},[userData,dispatch,LIMIT]);var handleLoadMore=useCallback(function(){setIsLoadMoreLoading(true);dispatch(getPostsAction(LIMIT,posts.length)).finally(function(){setIsLoadMoreLoading(false);});},[dispatch,LIMIT,posts.length]);var memoizedPosts=useMemo(function(){return posts.map(function(post){return/*#__PURE__*/_jsx(MemoizedPost,{post:post},post._id);});},[posts]);if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsx(CommonLoading,{})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:memoizedPosts}),posts.length>0&&posts.length<totalPosts&&/*#__PURE__*/_jsx(LoadMoreButton,{onClick:handleLoadMore,isLoading:isLoadMoreLoading}),posts.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-gray-700 flex justify-center items-center flex-col\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"py-5 font-semibold\",children:\"No posts to show. Join a community and post something.\"}),/*#__PURE__*/_jsx(\"img\",{loading:\"lazy\",src:Home,alt:\"no post\"})]})]});};export default MainSection;","map":{"version":3,"names":["memo","useMemo","useEffect","useState","useCallback","getPostsAction","clearPostsAction","useSelector","useDispatch","Post","CommonLoading","Home","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MemoizedPost","LoadMoreButton","_ref","onClick","isLoading","className","disabled","children","MainSection","_ref2","userData","dispatch","_useState","_useState2","_slicedToArray","setIsLoading","posts","state","_state$posts","totalPosts","_state$posts2","_useState3","_useState4","isLoadMoreLoading","setIsLoadMoreLoading","LIMIT","finally","handleLoadMore","length","memoizedPosts","map","post","_id","loading","src","alt"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/components/home/MainSection.jsx"],"sourcesContent":["import { memo, useMemo, useEffect, useState, useCallback } from \"react\";\nimport {\n  getPostsAction,\n  clearPostsAction,\n} from \"../../redux/actions/postActions\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport Post from \"../post/Post\";\nimport CommonLoading from \"../loader/CommonLoading\";\nimport Home from \"../../assets/home.jpg\";\n\nconst MemoizedPost = memo(Post);\n\nconst LoadMoreButton = ({ onClick, isLoading }) => (\n  <button\n    className=\"bg-primary hover:bg-blue-700 text-sm text-white font-semibold rounded-md w-full p-2 my-3\"\n    onClick={onClick}\n    disabled={isLoading}\n  >\n    {isLoading ? \"Loading...\" : \"Load More Posts\"}\n  </button>\n);\n\nconst MainSection = ({ userData }) => {\n  const dispatch = useDispatch();\n  const [isLoading, setIsLoading] = useState(true);\n  const posts = useSelector((state) => state.posts?.posts);\n  const totalPosts = useSelector((state) => state.posts?.totalPosts);\n  const [isLoadMoreLoading, setIsLoadMoreLoading] = useState(false);\n\n  const LIMIT = 10;\n\n  useEffect(() => {\n    if (userData) {\n      dispatch(getPostsAction(LIMIT, 0)).finally(() => {\n        setIsLoading(false);\n      });\n    }\n\n    return () => {\n      dispatch(clearPostsAction());\n    };\n  }, [userData, dispatch, LIMIT]);\n\n  const handleLoadMore = useCallback(() => {\n    setIsLoadMoreLoading(true);\n    dispatch(getPostsAction(LIMIT, posts.length)).finally(() => {\n      setIsLoadMoreLoading(false);\n    });\n  }, [dispatch, LIMIT, posts.length]);\n\n  const memoizedPosts = useMemo(() => {\n    return posts.map((post) => <MemoizedPost key={post._id} post={post} />);\n  }, [posts]);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center h-screen\">\n        <CommonLoading />\n      </div>\n    );\n  }\n  return (\n    <>\n      <div>{memoizedPosts}</div>\n\n      {posts.length > 0 && posts.length < totalPosts && (\n        <LoadMoreButton\n          onClick={handleLoadMore}\n          isLoading={isLoadMoreLoading}\n        />\n      )}\n\n      {posts.length === 0 && (\n        <div className=\"text-center text-gray-700 flex justify-center items-center flex-col\">\n          <p className=\"py-5 font-semibold\">\n            No posts to show. Join a community and post something.\n          </p>\n          <img loading=\"lazy\" src={Home} alt=\"no post\" />\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default MainSection;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}