{"ast":null,"code":"import _regeneratorRuntime from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from\"axios\";var API=axios.create({baseURL:process.env.REACT_APP_API_URL,headers:{\"Content-Type\":\"application/json\"}});API.interceptors.request.use(function(req){var _JSON$parse;var accessToken=(_JSON$parse=JSON.parse(localStorage.getItem(\"profile\")))===null||_JSON$parse===void 0?void 0:_JSON$parse.accessToken;if(accessToken){req.headers.Authorization=\"Bearer \".concat(accessToken);}return req;});export var refreshTokenAction=function refreshTokenAction(refreshToken){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var response,profile,payload;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return API.post(\"/users/refresh-token\",{refreshToken:refreshToken});case 3:response=_context.sent;profile=JSON.parse(localStorage.getItem(\"profile\"));payload=response.data;localStorage.setItem(\"profile\",JSON.stringify(_objectSpread(_objectSpread({},profile),payload)));dispatch({type:\"REFRESH_TOKEN_SUCCESS\",payload:payload});_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);localStorage.removeItem(\"profile\");dispatch({type:\"REFRESH_TOKEN_FAIL\",payload:_context.t0.response.data});case 14:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();};","map":{"version":3,"names":["axios","API","create","baseURL","process","env","REACT_APP_API_URL","headers","interceptors","request","use","req","_JSON$parse","accessToken","JSON","parse","localStorage","getItem","Authorization","concat","refreshTokenAction","refreshToken","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","response","profile","payload","wrap","_callee$","_context","prev","next","post","sent","data","setItem","stringify","_objectSpread","type","t0","removeItem","stop","_x","apply","arguments"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/redux/actions/refreshTokenAction.js"],"sourcesContent":["import axios from \"axios\";\nconst API = axios.create({\n  baseURL: process.env.REACT_APP_API_URL,\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n});\n\nAPI.interceptors.request.use((req) => {\n  const accessToken = JSON.parse(localStorage.getItem(\"profile\"))?.accessToken;\n  if (accessToken) {\n    req.headers.Authorization = `Bearer ${accessToken}`;\n  }\n  return req;\n});\nexport const refreshTokenAction = (refreshToken) => async (dispatch) => {\n  try {\n    const response = await API.post(\"/users/refresh-token\", {\n      refreshToken,\n    });\n    const profile = JSON.parse(localStorage.getItem(\"profile\"));\n    const payload = response.data;\n    localStorage.setItem(\"profile\", JSON.stringify({ ...profile, ...payload }));\n    dispatch({\n      type: \"REFRESH_TOKEN_SUCCESS\",\n      payload: payload,\n    });\n  } catch (error) {\n    localStorage.removeItem(\"profile\");\n    dispatch({\n      type: \"REFRESH_TOKEN_FAIL\",\n      payload: error.response.data,\n    });\n  }\n};\n"],"mappings":"6aAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,GAAM,CAAAC,GAAG,CAAGD,KAAK,CAACE,MAAM,CAAC,CACvBC,OAAO,CAAEC,OAAO,CAACC,GAAG,CAACC,iBAAiB,CACtCC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CAEFN,GAAG,CAACO,YAAY,CAACC,OAAO,CAACC,GAAG,CAAC,SAACC,GAAG,CAAK,KAAAC,WAAA,CACpC,GAAM,CAAAC,WAAW,EAAAD,WAAA,CAAGE,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC,UAAAL,WAAA,iBAA3CA,WAAA,CAA6CC,WAAW,CAC5E,GAAIA,WAAW,CAAE,CACfF,GAAG,CAACJ,OAAO,CAACW,aAAa,WAAAC,MAAA,CAAaN,WAAW,CAAE,CACrD,CACA,MAAO,CAAAF,GAAG,CACZ,CAAC,CAAC,CACF,MAAO,IAAM,CAAAS,kBAAkB,CAAG,QAArB,CAAAA,kBAAkBA,CAAIC,YAAY,oCAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAK,SAAAC,QAAOC,QAAQ,MAAAC,QAAA,CAAAC,OAAA,CAAAC,OAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAExC,CAAAlC,GAAG,CAACmC,IAAI,CAAC,sBAAsB,CAAE,CACtDf,YAAY,CAAZA,YACF,CAAC,CAAC,QAFIO,QAAQ,CAAAK,QAAA,CAAAI,IAAA,CAGRR,OAAO,CAAGf,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC,CACrDa,OAAO,CAAGF,QAAQ,CAACU,IAAI,CAC7BtB,YAAY,CAACuB,OAAO,CAAC,SAAS,CAAEzB,IAAI,CAAC0B,SAAS,CAAAC,aAAA,CAAAA,aAAA,IAAMZ,OAAO,EAAKC,OAAO,CAAE,CAAC,CAAC,CAC3EH,QAAQ,CAAC,CACPe,IAAI,CAAE,uBAAuB,CAC7BZ,OAAO,CAAEA,OACX,CAAC,CAAC,CAACG,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAU,EAAA,CAAAV,QAAA,aAEHjB,YAAY,CAAC4B,UAAU,CAAC,SAAS,CAAC,CAClCjB,QAAQ,CAAC,CACPe,IAAI,CAAE,oBAAoB,CAC1BZ,OAAO,CAAEG,QAAA,CAAAU,EAAA,CAAMf,QAAQ,CAACU,IAC1B,CAAC,CAAC,CAAC,yBAAAL,QAAA,CAAAY,IAAA,MAAAnB,OAAA,iBAEN,mBAAAoB,EAAA,SAAAxB,IAAA,CAAAyB,KAAA,MAAAC,SAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}