{"ast":null,"code":"import _regeneratorRuntime from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{HiOutlineHandThumbUp,HiHandThumbUp}from\"react-icons/hi2\";import{useDispatch,useSelector}from\"react-redux\";import{likePostAction,unlikePostAction}from\"../../redux/actions/postActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Like=function Like(_ref){var post=_ref.post;var dispatch=useDispatch();var _id=post._id,likes=post.likes;var userData=useSelector(function(state){var _state$auth;return(_state$auth=state.auth)===null||_state$auth===void 0?void 0:_state$auth.userData;});var _useState=useState({liked:post.likes.includes(userData._id),localLikes:likes.length}),_useState2=_slicedToArray(_useState,2),likeState=_useState2[0],setLikeState=_useState2[1];useEffect(function(){setLikeState({liked:post.likes.includes(userData._id),localLikes:post.likes.length});},[post.likes,userData._id]);var toggleLike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var optimisticLikes;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();optimisticLikes=likeState.liked?likeState.localLikes-1:likeState.localLikes+1;setLikeState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{liked:!prevState.liked,localLikes:optimisticLikes});});try{if(likeState.liked){dispatch(unlikePostAction(_id));}else{dispatch(likePostAction(_id));}}catch(error){setLikeState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{liked:!prevState.liked,localLikes:optimisticLikes});});}case 4:case\"end\":return _context.stop();}},_callee);}));return function toggleLike(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"button\",{onClick:toggleLike,className:\"flex items-center cursor-pointer gap-1 text-lg\",children:[likeState.liked?/*#__PURE__*/_jsx(HiHandThumbUp,{className:\"text-2xl\"}):/*#__PURE__*/_jsx(HiOutlineHandThumbUp,{className:\"text-2xl\"}),\" \",likeState.localLikes]});};export default Like;","map":{"version":3,"names":["useState","useEffect","HiOutlineHandThumbUp","HiHandThumbUp","useDispatch","useSelector","likePostAction","unlikePostAction","jsx","_jsx","jsxs","_jsxs","Like","_ref","post","dispatch","_id","likes","userData","state","_state$auth","auth","_useState","liked","includes","localLikes","length","_useState2","_slicedToArray","likeState","setLikeState","toggleLike","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","optimisticLikes","wrap","_callee$","_context","prev","next","preventDefault","prevState","_objectSpread","error","stop","_x","apply","arguments","onClick","className","children"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/components/post/Like.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { HiOutlineHandThumbUp, HiHandThumbUp } from \"react-icons/hi2\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  likePostAction,\n  unlikePostAction,\n} from \"../../redux/actions/postActions\";\n\nconst Like = ({ post }) => {\n  const dispatch = useDispatch();\n  const { _id, likes } = post;\n  const userData = useSelector((state) => state.auth?.userData);\n\n  const [likeState, setLikeState] = useState({\n    liked: post.likes.includes(userData._id),\n    localLikes: likes.length,\n  });\n\n  useEffect(() => {\n    setLikeState({\n      liked: post.likes.includes(userData._id),\n      localLikes: post.likes.length,\n    });\n  }, [post.likes, userData._id]);\n\n  const toggleLike = async (e) => {\n    e.preventDefault();\n    const optimisticLikes = likeState.liked\n      ? likeState.localLikes - 1\n      : likeState.localLikes + 1;\n\n    setLikeState((prevState) => ({\n      ...prevState,\n      liked: !prevState.liked,\n      localLikes: optimisticLikes,\n    }));\n\n    try {\n      if (likeState.liked) {\n        dispatch(unlikePostAction(_id));\n      } else {\n        dispatch(likePostAction(_id));\n      }\n    } catch (error) {\n      setLikeState((prevState) => ({\n        ...prevState,\n        liked: !prevState.liked,\n        localLikes: optimisticLikes,\n      }));\n    }\n  };\n\n  return (\n    <button\n      onClick={toggleLike}\n      className=\"flex items-center cursor-pointer gap-1 text-lg\"\n    >\n      {likeState.liked ? (\n        <HiHandThumbUp className=\"text-2xl\" />\n      ) : (\n        <HiOutlineHandThumbUp className=\"text-2xl\" />\n      )}{\" \"}\n      {likeState.localLikes}\n    </button>\n  );\n};\n\nexport default Like;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}