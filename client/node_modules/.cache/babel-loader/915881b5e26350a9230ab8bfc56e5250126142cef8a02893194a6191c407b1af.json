{"ast":null,"code":"import _slicedToArray from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useMemo,useEffect,useState}from\"react\";import{Navigate,Outlet,useLocation,useNavigate}from\"react-router-dom\";import{useDispatch}from\"react-redux\";import{setInitialAuthState}from\"./redux/actions/authActions\";import Navbar from\"./components/shared/Navbar\";import Leftbar from\"./components/shared/Leftbar\";import Rightbar from\"./components/shared/Rightbar\";import ModeratorRightbar from\"./components/moderator/Rightbar\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var noRightbarRoutes=[/\\/post\\/[^/]+$/,/\\/community\\/[^/]+$/,/\\/community\\/[^/]+\\/report$/,/\\/community\\/[^/]+\\/reported-post$/,/\\/community\\/[^/]+\\/moderator$/].map(function(regex){return new RegExp(regex);});var PrivateRoute=function PrivateRoute(_ref){var _JSON$parse;var userData=_ref.userData;var isAuthenticated=useMemo(function(){return function(userData,accessToken){return userData&&accessToken;};},[]);var location=useLocation();var navigate=useNavigate();var dispatch=useDispatch();var token=localStorage.getItem(\"profile\");var accessToken=(_JSON$parse=JSON.parse(token))===null||_JSON$parse===void 0?void 0:_JSON$parse.accessToken;var currentUserIsModerator=(userData===null||userData===void 0?void 0:userData.role)===\"moderator\";useEffect(function(){if(!isAuthenticated(userData,accessToken)){dispatch(setInitialAuthState(navigate));}},[dispatch,navigate,userData,accessToken,isAuthenticated]);var showRightbar=!noRightbarRoutes.some(function(regex){return regex.test(location.pathname);});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showLeftbar=_useState2[0],setShowLeftbar=_useState2[1];var toggleLeftbar=function toggleLeftbar(){setShowLeftbar(!showLeftbar);};return isAuthenticated(userData,accessToken)?/*#__PURE__*/_jsxs(\"div\",{className:\"scroll-smooth\",children:[/*#__PURE__*/_jsx(Navbar,{userData:userData,toggleLeftbar:toggleLeftbar,showLeftbar:showLeftbar}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:mx-auto md:grid md:w-10/12 md:grid-cols-4 md:gap-6\",children:[/*#__PURE__*/_jsx(Leftbar,{showLeftbar:showLeftbar}),/*#__PURE__*/_jsx(Outlet,{}),showRightbar?currentUserIsModerator?/*#__PURE__*/_jsx(ModeratorRightbar,{}):/*#__PURE__*/_jsx(Rightbar,{}):null]})]}):/*#__PURE__*/_jsx(Navigate,{to:\"/signin\"});};export default PrivateRoute;","map":{"version":3,"names":["useMemo","useEffect","useState","Navigate","Outlet","useLocation","useNavigate","useDispatch","setInitialAuthState","Navbar","Leftbar","Rightbar","ModeratorRightbar","jsx","_jsx","jsxs","_jsxs","noRightbarRoutes","map","regex","RegExp","PrivateRoute","_ref","_JSON$parse","userData","isAuthenticated","accessToken","location","navigate","dispatch","token","localStorage","getItem","JSON","parse","currentUserIsModerator","role","showRightbar","some","test","pathname","_useState","_useState2","_slicedToArray","showLeftbar","setShowLeftbar","toggleLeftbar","className","children","to"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/PrivateRoute.jsx"],"sourcesContent":["import { useMemo, useEffect, useState } from \"react\";\nimport { Navigate, Outlet, useLocation, useNavigate } from \"react-router-dom\";\nimport { useDispatch } from \"react-redux\";\nimport { setInitialAuthState } from \"./redux/actions/authActions\";\nimport Navbar from \"./components/shared/Navbar\";\nimport Leftbar from \"./components/shared/Leftbar\";\nimport Rightbar from \"./components/shared/Rightbar\";\n\nimport ModeratorRightbar from \"./components/moderator/Rightbar\";\n\nconst noRightbarRoutes = [\n  /\\/post\\/[^/]+$/,\n  /\\/community\\/[^/]+$/,\n  /\\/community\\/[^/]+\\/report$/,\n  /\\/community\\/[^/]+\\/reported-post$/,\n  /\\/community\\/[^/]+\\/moderator$/,\n].map((regex) => new RegExp(regex));\n\nconst PrivateRoute = ({ userData }) => {\n  const isAuthenticated = useMemo(() => {\n    return (userData, accessToken) => {\n      return userData && accessToken;\n    };\n  }, []);\n\n  const location = useLocation();\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const token = localStorage.getItem(\"profile\");\n  const accessToken = JSON.parse(token)?.accessToken;\n\n  const currentUserIsModerator = userData?.role === \"moderator\";\n\n  useEffect(() => {\n    if (!isAuthenticated(userData, accessToken)) {\n      dispatch(setInitialAuthState(navigate));\n    }\n  }, [dispatch, navigate, userData, accessToken, isAuthenticated]);\n\n  const showRightbar = !noRightbarRoutes.some((regex) =>\n    regex.test(location.pathname)\n  );\n\n  const [showLeftbar, setShowLeftbar] = useState(false);\n\n  const toggleLeftbar = () => {\n    setShowLeftbar(!showLeftbar);\n  };\n\n  return isAuthenticated(userData, accessToken) ? (\n    <div className=\"scroll-smooth\">\n      <Navbar\n        userData={userData}\n        toggleLeftbar={toggleLeftbar}\n        showLeftbar={showLeftbar}\n      />\n\n      <div className=\"md:mx-auto md:grid md:w-10/12 md:grid-cols-4 md:gap-6\">\n        <Leftbar showLeftbar={showLeftbar} />\n\n        <Outlet />\n\n        {showRightbar ? (\n          currentUserIsModerator ? (\n            <ModeratorRightbar />\n          ) : (\n            <Rightbar />\n          )\n        ) : null}\n      </div>\n    </div>\n  ) : (\n    <Navigate to=\"/signin\" />\n  );\n};\n\nexport default PrivateRoute;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}