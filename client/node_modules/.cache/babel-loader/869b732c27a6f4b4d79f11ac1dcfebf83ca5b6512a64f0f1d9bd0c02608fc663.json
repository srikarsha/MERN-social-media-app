{"ast":null,"code":"import{useSelector,useDispatch}from\"react-redux\";import{useEffect,lazy,useMemo,Suspense}from\"react\";import{getPostAction,clearPostAction}from\"../redux/actions/postActions\";import{useParams,useNavigate}from\"react-router-dom\";import CommonLoading from\"../components/loader/CommonLoading\";import FallbackLoading from\"../components/loader/FallbackLoading\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PostView=/*#__PURE__*/lazy(function(){return import(\"../components/post/PostView\");});var CommentSidebar=/*#__PURE__*/lazy(function(){return import(\"../components/post/CommentSidebar\");});var Post=function Post(){var _useParams=useParams(),postId=_useParams.postId;var dispatch=useDispatch();var navigate=useNavigate();var userData=useSelector(function(state){var _state$auth;return(_state$auth=state.auth)===null||_state$auth===void 0?void 0:_state$auth.userData;});var joinedCommunities=useSelector(function(state){var _state$community,_state$community$join;return(_state$community=state.community)===null||_state$community===void 0?void 0:(_state$community$join=_state$community.joinedCommunities)===null||_state$community$join===void 0?void 0:_state$community$join.map(function(_ref){var _id=_ref._id;return _id;});});useEffect(function(){dispatch(getPostAction(postId));return function(){dispatch(clearPostAction());};},[dispatch,postId]);var post=useSelector(function(state){var _state$posts;return(_state$posts=state.posts)===null||_state$posts===void 0?void 0:_state$posts.post;});var isAuthorized=useMemo(function(){return post&&(joinedCommunities===null||joinedCommunities===void 0?void 0:joinedCommunities.includes(post.community._id));},[post,joinedCommunities]);useEffect(function(){if(isAuthorized===false){navigate(\"/access-denied\");}},[isAuthorized,navigate]);if(!post||!joinedCommunities){return/*#__PURE__*/_jsx(\"div\",{className:\"col-span-3 flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsx(CommonLoading,{})});}return/*#__PURE__*/_jsxs(Suspense,{fallback:/*#__PURE__*/_jsx(FallbackLoading,{}),children:[/*#__PURE__*/_jsx(PostView,{post:post,userData:userData}),/*#__PURE__*/_jsx(CommentSidebar,{comments:post.comments})]});};export default Post;","map":{"version":3,"names":["useSelector","useDispatch","useEffect","lazy","useMemo","Suspense","getPostAction","clearPostAction","useParams","useNavigate","CommonLoading","FallbackLoading","jsx","_jsx","jsxs","_jsxs","PostView","CommentSidebar","Post","_useParams","postId","dispatch","navigate","userData","state","_state$auth","auth","joinedCommunities","_state$community","_state$community$join","community","map","_ref","_id","post","_state$posts","posts","isAuthorized","includes","className","children","fallback","comments"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/pages/Post.jsx"],"sourcesContent":["import { useSelector, useDispatch } from \"react-redux\";\nimport { useEffect, lazy, useMemo, Suspense } from \"react\";\nimport { getPostAction, clearPostAction } from \"../redux/actions/postActions\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport CommonLoading from \"../components/loader/CommonLoading\";\nimport FallbackLoading from \"../components/loader/FallbackLoading\";\n\nconst PostView = lazy(() => import(\"../components/post/PostView\"));\nconst CommentSidebar = lazy(() => import(\"../components/post/CommentSidebar\"));\n\nconst Post = () => {\n  const { postId } = useParams();\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const userData = useSelector((state) => state.auth?.userData);\n\n  const joinedCommunities = useSelector((state) =>\n    state.community?.joinedCommunities?.map(({ _id }) => _id)\n  );\n\n  useEffect(() => {\n    dispatch(getPostAction(postId));\n\n    return () => {\n      dispatch(clearPostAction());\n    };\n  }, [dispatch, postId]);\n\n  const post = useSelector((state) => state.posts?.post);\n\n  const isAuthorized = useMemo(() => {\n    return post && joinedCommunities?.includes(post.community._id);\n  }, [post, joinedCommunities]);\n\n  useEffect(() => {\n    if (isAuthorized === false) {\n      navigate(\"/access-denied\");\n    }\n  }, [isAuthorized, navigate]);\n\n  if (!post || !joinedCommunities) {\n    return (\n      <div className=\"col-span-3 flex justify-center items-center h-screen\">\n        <CommonLoading />\n      </div>\n    );\n  }\n  return (\n    <Suspense fallback={<FallbackLoading />}>\n      <PostView post={post} userData={userData} />\n      <CommentSidebar comments={post.comments} />\n    </Suspense>\n  );\n};\n\nexport default Post;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}