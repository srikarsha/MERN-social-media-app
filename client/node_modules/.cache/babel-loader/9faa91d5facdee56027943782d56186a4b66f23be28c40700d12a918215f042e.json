{"ast":null,"code":"var _jsxFileName = \"E:\\\\SEM 4\\\\MERN\\\\end_sem_project\\\\SocialEcho-main\\\\client\\\\src\\\\components\\\\community\\\\MainSection.jsx\",\n  _s = $RefreshSig$();\nimport { memo, useEffect, useMemo, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { getComPostsAction, clearCommunityPostsAction } from \"../../redux/actions/postActions\";\nimport PostForm from \"../form/PostForm\";\nimport Post from \"../post/Post\";\nimport FollowingUsersPosts from \"./FollowingUsersPosts\";\nimport CommonLoading from \"../loader/CommonLoading\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst MemoizedPost = /*#__PURE__*/memo(Post);\n_c = MemoizedPost;\nconst MainSection = () => {\n  _s();\n  const dispatch = useDispatch();\n  const communityData = useSelector(state => {\n    var _state$community;\n    return (_state$community = state.community) === null || _state$community === void 0 ? void 0 : _state$community.communityData;\n  });\n  const communityPosts = useSelector(state => {\n    var _state$posts;\n    return (_state$posts = state.posts) === null || _state$posts === void 0 ? void 0 : _state$posts.communityPosts;\n  });\n  const totalCommunityPosts = useSelector(state => {\n    var _state$posts2;\n    return (_state$posts2 = state.posts) === null || _state$posts2 === void 0 ? void 0 : _state$posts2.totalCommunityPosts;\n  });\n  const [activeTab, setActiveTab] = useState(\"All posts\");\n  const [isLoading, setIsLoading] = useState(true);\n  const [isLoadMoreLoading, setIsLoadMoreLoading] = useState(false);\n  const LIMIT = 10;\n  const postError = useSelector(state => {\n    var _state$posts3;\n    return (_state$posts3 = state.posts) === null || _state$posts3 === void 0 ? void 0 : _state$posts3.postError;\n  });\n  useEffect(() => {\n    const fetchInitialPosts = async () => {\n      if (communityData !== null && communityData !== void 0 && communityData._id) {\n        dispatch(getComPostsAction(communityData._id, LIMIT, 0)).finally(() => {\n          setIsLoading(false);\n        });\n      }\n    };\n    fetchInitialPosts();\n    return () => {\n      dispatch(clearCommunityPostsAction());\n    };\n  }, [dispatch, communityData]);\n  const handleLoadMore = () => {\n    if (!isLoadMoreLoading && communityPosts.length > 0 && communityPosts.length < totalCommunityPosts) {\n      setIsLoadMoreLoading(true);\n      dispatch(getComPostsAction(communityData._id, LIMIT, communityPosts.length)).finally(() => {\n        setIsLoadMoreLoading(false);\n      });\n    }\n  };\n  const memoizedCommunityPosts = useMemo(() => {\n    return communityPosts === null || communityPosts === void 0 ? void 0 : communityPosts.map(post => /*#__PURE__*/_jsxDEV(MemoizedPost, {\n      post: post\n    }, post._id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this));\n  }, [communityPosts]);\n  if (isLoading || !communityData || !communityPosts) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-section flex items-center justify-center h-screen\",\n      children: /*#__PURE__*/_jsxDEV(CommonLoading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col\",\n    children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"flex\",\n      children: [/*#__PURE__*/_jsxDEV(\"li\", {\n        className: `${activeTab === \"All posts\" ? \"border-blue-500 bg-primary rounded-md text-white\" : \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"} flex-1 cursor-pointer text-center py-2 px-1 border-b-2 font-medium`,\n        onClick: () => setActiveTab(\"All posts\"),\n        children: \"All post\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n        className: `${activeTab === \"You're following\" ? \"border-blue-500 bg-primary rounded-md text-white\" : \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"} flex-1 cursor-pointer text-center py-2 px-1 border-b-2 font-medium`,\n        onClick: () => setActiveTab(\"You're following\"),\n        children: \"You're following\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-4 flex flex-col gap-4\",\n      children: [activeTab === \"All posts\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4\",\n          children: /*#__PURE__*/_jsxDEV(PostForm, {\n            communityId: communityData._id,\n            communityName: communityData.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this), postError && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500 bg-red-100 border border-red-500 p-3 rounded-md text-center mx-auto\",\n          children: postError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: memoizedCommunityPosts\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }, this), communityPosts.length < totalCommunityPosts && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"bg-primary hover:bg-blue-700 text-sm text-white font-semibold rounded-md w-full p-2 my-3\",\n          onClick: handleLoadMore,\n          disabled: isLoadMoreLoading,\n          children: isLoadMoreLoading ? \"Loading...\" : \"Load More Posts\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true), activeTab === \"You're following\" && /*#__PURE__*/_jsxDEV(FollowingUsersPosts, {\n        communityData: communityData\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 5\n  }, this);\n};\n_s(MainSection, \"PbGczpF1SfGhQNXz5BAGEk8D4uc=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector];\n});\n_c2 = MainSection;\nexport default MainSection;\nvar _c, _c2;\n$RefreshReg$(_c, \"MemoizedPost\");\n$RefreshReg$(_c2, \"MainSection\");","map":{"version":3,"names":["memo","useEffect","useMemo","useState","useSelector","useDispatch","getComPostsAction","clearCommunityPostsAction","PostForm","Post","FollowingUsersPosts","CommonLoading","jsxDEV","_jsxDEV","Fragment","_Fragment","MemoizedPost","_c","MainSection","_s","dispatch","communityData","state","_state$community","community","communityPosts","_state$posts","posts","totalCommunityPosts","_state$posts2","activeTab","setActiveTab","isLoading","setIsLoading","isLoadMoreLoading","setIsLoadMoreLoading","LIMIT","postError","_state$posts3","fetchInitialPosts","_id","finally","handleLoadMore","length","memoizedCommunityPosts","map","post","fileName","_jsxFileName","lineNumber","columnNumber","className","children","onClick","communityId","communityName","name","disabled","_c2","$RefreshReg$"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/components/community/MainSection.jsx"],"sourcesContent":["import { memo, useEffect, useMemo, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport {\n  getComPostsAction,\n  clearCommunityPostsAction,\n} from \"../../redux/actions/postActions\";\nimport PostForm from \"../form/PostForm\";\nimport Post from \"../post/Post\";\nimport FollowingUsersPosts from \"./FollowingUsersPosts\";\nimport CommonLoading from \"../loader/CommonLoading\";\n\nconst MemoizedPost = memo(Post);\n\nconst MainSection = () => {\n  const dispatch = useDispatch();\n\n  const communityData = useSelector((state) => state.community?.communityData);\n  const communityPosts = useSelector((state) => state.posts?.communityPosts);\n\n  const totalCommunityPosts = useSelector(\n    (state) => state.posts?.totalCommunityPosts\n  );\n\n  const [activeTab, setActiveTab] = useState(\"All posts\");\n  const [isLoading, setIsLoading] = useState(true);\n  const [isLoadMoreLoading, setIsLoadMoreLoading] = useState(false);\n  const LIMIT = 10;\n\n  const postError = useSelector((state) => state.posts?.postError);\n\n  useEffect(() => {\n    const fetchInitialPosts = async () => {\n      if (communityData?._id) {\n        dispatch(getComPostsAction(communityData._id, LIMIT, 0)).finally(() => {\n          setIsLoading(false);\n        });\n      }\n    };\n\n    fetchInitialPosts();\n\n    return () => {\n      dispatch(clearCommunityPostsAction());\n    };\n  }, [dispatch, communityData]);\n\n  const handleLoadMore = () => {\n    if (\n      !isLoadMoreLoading &&\n      communityPosts.length > 0 &&\n      communityPosts.length < totalCommunityPosts\n    ) {\n      setIsLoadMoreLoading(true);\n      dispatch(\n        getComPostsAction(communityData._id, LIMIT, communityPosts.length)\n      ).finally(() => {\n        setIsLoadMoreLoading(false);\n      });\n    }\n  };\n\n  const memoizedCommunityPosts = useMemo(() => {\n    return communityPosts?.map((post) => (\n      <MemoizedPost key={post._id} post={post} />\n    ));\n  }, [communityPosts]);\n\n  if (isLoading || !communityData || !communityPosts) {\n    return (\n      <div className=\"main-section flex items-center justify-center h-screen\">\n        <CommonLoading />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col\">\n      <ul className=\"flex\">\n        <li\n          className={`${\n            activeTab === \"All posts\"\n              ? \"border-blue-500 bg-primary rounded-md text-white\"\n              : \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\n          } flex-1 cursor-pointer text-center py-2 px-1 border-b-2 font-medium`}\n          onClick={() => setActiveTab(\"All posts\")}\n        >\n          All post\n        </li>\n        <li\n          className={`${\n            activeTab === \"You're following\"\n              ? \"border-blue-500 bg-primary rounded-md text-white\"\n              : \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\n          } flex-1 cursor-pointer text-center py-2 px-1 border-b-2 font-medium`}\n          onClick={() => setActiveTab(\"You're following\")}\n        >\n          You're following\n        </li>\n      </ul>\n      <div className=\"mt-4 flex flex-col gap-4\">\n        {activeTab === \"All posts\" && (\n          <>\n            <div className=\"mb-4\">\n              <PostForm\n                communityId={communityData._id}\n                communityName={communityData.name}\n              />\n            </div>\n            {postError && (\n              <div className=\"text-red-500 bg-red-100 border border-red-500 p-3 rounded-md text-center mx-auto\">\n                {postError}\n              </div>\n            )}\n\n            <div>{memoizedCommunityPosts}</div>\n            {communityPosts.length < totalCommunityPosts && (\n              <button\n                className=\"bg-primary hover:bg-blue-700 text-sm text-white font-semibold rounded-md w-full p-2 my-3\"\n                onClick={handleLoadMore}\n                disabled={isLoadMoreLoading}\n              >\n                {isLoadMoreLoading ? \"Loading...\" : \"Load More Posts\"}\n              </button>\n            )}\n          </>\n        )}\n        {activeTab === \"You're following\" && (\n          <FollowingUsersPosts communityData={communityData} />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default MainSection;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}