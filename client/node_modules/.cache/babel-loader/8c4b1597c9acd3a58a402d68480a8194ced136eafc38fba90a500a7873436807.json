{"ast":null,"code":"import _regeneratorRuntime from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{addCommentAction,getPostAction,getComPostsAction,getOwnPostAction,clearCommentFailAction}from\"../../redux/actions/postActions\";import{useDispatch,useSelector}from\"react-redux\";import InappropriatePost from\"../modals/InappropriatePostModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommentForm=function CommentForm(_ref){var communityId=_ref.communityId,postId=_ref.postId;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showInappropriateContentModal=_useState2[0],setShowInappropriateContentModal=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),content=_useState4[0],setContent=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newComment;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();newComment={content:content,postId:postId};_context.prev=2;setIsLoading(true);_context.next=6;return dispatch(addCommentAction(postId,newComment));case 6:_context.next=8;return dispatch(getPostAction(postId));case 8:_context.next=10;return dispatch(getOwnPostAction(postId));case 10:setIsLoading(false);setContent(\"\");_context.next=14;return dispatch(getComPostsAction(communityId));case 14:_context.prev=14;setIsLoading(false);return _context.finish(14);case 17:case\"end\":return _context.stop();}},_callee,null,[[2,,14,17]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var isCommentInappropriate=useSelector(function(state){var _state$posts;return(_state$posts=state.posts)===null||_state$posts===void 0?void 0:_state$posts.isCommentInappropriate;});useEffect(function(){if(isCommentInappropriate){setShowInappropriateContentModal(true);}},[isCommentInappropriate]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(InappropriatePost,{closeInappropriateContentModal:function closeInappropriateContentModal(){setShowInappropriateContentModal(false);dispatch(clearCommentFailAction());},showInappropriateContentModal:showInappropriateContentModal,contentType:\"comment\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"my-4\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full px-3 py-2 border rounded-md focus:outline-none focus:border-blue-500 resize-none\",name:\"content\",value:content,onChange:function onChange(e){return setContent(e.target.value);},maxLength:500,required:true,placeholder:\"Write a comment...\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-blue-600 focus:outline-none focus:bg-blue-600\",type:\"submit\",disabled:isLoading,style:{opacity:isLoading?0.5:1,cursor:isLoading?\"not-allowed\":\"pointer\"},children:isLoading?\"Loading...\":\"Comment\"})})]})]});};export default CommentForm;","map":{"version":3,"names":["useState","useEffect","addCommentAction","getPostAction","getComPostsAction","getOwnPostAction","clearCommentFailAction","useDispatch","useSelector","InappropriatePost","jsx","_jsx","jsxs","_jsxs","CommentForm","_ref","communityId","postId","dispatch","_useState","_useState2","_slicedToArray","showInappropriateContentModal","setShowInappropriateContentModal","_useState3","_useState4","content","setContent","_useState5","_useState6","isLoading","setIsLoading","handleSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","newComment","wrap","_callee$","_context","prev","next","preventDefault","finish","stop","_x","apply","arguments","isCommentInappropriate","state","_state$posts","posts","children","closeInappropriateContentModal","contentType","onSubmit","className","name","value","onChange","target","maxLength","required","placeholder","type","disabled","style","opacity","cursor"],"sources":["E:/SEM 4/MERN/end_sem_project/SocialEcho-main/client/src/components/form/CommentForm.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport {\n  addCommentAction,\n  getPostAction,\n  getComPostsAction,\n  getOwnPostAction,\n  clearCommentFailAction,\n} from \"../../redux/actions/postActions\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport InappropriatePost from \"../modals/InappropriatePostModal\";\n\nconst CommentForm = ({ communityId, postId }) => {\n  const dispatch = useDispatch();\n  const [showInappropriateContentModal, setShowInappropriateContentModal] =\n    useState(false);\n\n  const [content, setContent] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const newComment = {\n      content,\n      postId,\n    };\n    try {\n      setIsLoading(true);\n      await dispatch(addCommentAction(postId, newComment));\n      await dispatch(getPostAction(postId));\n      await dispatch(getOwnPostAction(postId));\n\n      setIsLoading(false);\n      setContent(\"\");\n\n      await dispatch(getComPostsAction(communityId));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const isCommentInappropriate = useSelector(\n    (state) => state.posts?.isCommentInappropriate\n  );\n\n  useEffect(() => {\n    if (isCommentInappropriate) {\n      setShowInappropriateContentModal(true);\n    }\n  }, [isCommentInappropriate]);\n\n  return (\n    <div>\n      <InappropriatePost\n        closeInappropriateContentModal={() => {\n          setShowInappropriateContentModal(false);\n          dispatch(clearCommentFailAction());\n        }}\n        showInappropriateContentModal={showInappropriateContentModal}\n        contentType={\"comment\"}\n      />\n\n      <form onSubmit={handleSubmit}>\n        <div className=\"my-4\">\n          <textarea\n            className=\"w-full px-3 py-2 border rounded-md focus:outline-none focus:border-blue-500 resize-none\"\n            name=\"content\"\n            value={content}\n            onChange={(e) => setContent(e.target.value)}\n            maxLength={500}\n            required\n            placeholder=\"Write a comment...\"\n          />\n        </div>\n        <div className=\"flex justify-end\">\n          <button\n            className=\"px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-blue-600 focus:outline-none focus:bg-blue-600\"\n            type=\"submit\"\n            disabled={isLoading}\n            style={{\n              opacity: isLoading ? 0.5 : 1,\n              cursor: isLoading ? \"not-allowed\" : \"pointer\",\n            }}\n          >\n            {isLoading ? \"Loading...\" : \"Comment\"}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default CommentForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}